(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([[117],{1371:function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return S}));var r=n(0),a=n(7),o=n.n(a),i=n(21),c=n.n(i),l=n(11),s=n(142),u=n(495),p=n(120),d=n(86),f=n(1388),m=n.n(f);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=O(e);if(t){var a=O(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v(this,n)}}function v(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=/^[0-9]{1}$/,E=/^[0-9]{6}$/,S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(f,e);var t,n,a,i=y(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=i.call(this,e)).handleEditClick=function(e){var n=t.props.handleEdit;"function"==typeof n&&n(e)},t.handleOtpPaste=function(e){if(e){e.preventDefault();var n=e.clipboardData||window.clipboardData,r=n&&n.getData("text");if(r&&E.test(r)){var a=r.split("");t.setState({otp:a,focusIndex:5})}}},t.handleOtpChange=function(e,n){var r=t.props.handleChangeInOTP,a=t.state.otp;a[n]=e,t.skipOnChange?t.setState({otp:a}):t.setState({otp:a,focusIndex:t.getFocusIndexBoundary(n+1)},(function(){"function"==typeof r&&r(a)}))},t.handleSubmit=function(e){e&&e.preventDefault();var n=t.state.otp,r=t.props.handleOTPSubmit,a=n.join("");"function"==typeof r&&r(a)},t.handleResendClick=function(){var e=t.props.handleResendOTP;"function"==typeof e&&e()},t.getFocusIndexBoundary=function(e){return e<0?0:e>5?5:e},t.handleKeyDown=function(e){return function(n){var r=t.state.otp,a=t.state;switch(n.keyCode){case p.a.backspace:if(t.skipOnChange=!0,""!==r[e]&&void 0!==r[e]){r[e]="",Object.assign(a,{otp:r,focusIndex:t.getFocusIndexBoundary(e)});break}Object.assign(a,{otp:r,focusIndex:t.getFocusIndexBoundary(e-1)});break;case p.a.left:Object.assign(a,{focusIndex:t.getFocusIndexBoundary(e-1)});break;case p.a.right:Object.assign(a,{focusIndex:t.getFocusIndexBoundary(e+1)});break;default:return void(t.skipOnChange=!1)}t.setState(a)}},t.state={otp:[],focusIndex:0},t.skipOnChange=!1,t}return t=f,(n=[{key:"componentDidMount",value:function(){c.a.canUseDOM&&document.addEventListener("paste",this.handleOtpPaste)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("paste",this.handleOtpPaste)}},{key:"render",value:function(){for(var e=this.props,t=e.userName,n=void 0===t?"":t,a=e.showEditButton,i=e.className,c=[],p=0;p<6;p++)c.push(r.createElement(u.a,{maxLength:1,key:p,id:p,wrapperClass:m.a["input-wrapper"],className:m.a.input,required:!0,autoFocus:p===this.state.focusIndex,value:this.state.otp[p],pattern:w,onKeyDown:this.handleKeyDown(p),onTextChange:this.handleOtpChange}));return r.createElement("div",{className:o()(m.a["login-otp-verification"],i)},r.createElement("div",null,Object(l.d)("loginOTPVerificationTitle")),r.createElement("div",null,n&&r.createElement("span",{className:m.a.username},n),a&&r.createElement(s.a,{link:!0,href:d.s,onClick:this.handleEditClick},Object(l.d)("changeButton"))),r.createElement("form",{onSubmit:this.handleSubmit},r.createElement("div",{className:m.a["input-container"]},c),r.createElement(s.a,{primary:!0,type:"submit",className:m.a["submit-btn"]},Object(l.d)("loginVerifyBtnTxt"))),r.createElement("div",{className:m.a["resend-container"]},Object(l.d)("loginOTPResend"),r.createElement("span",{className:m.a.btn,onClick:this.handleResendClick},Object(l.d)("loginResendCode"))))}}])&&h(t.prototype,n),a&&h(t,a),f}(r.Component)},1388:function(e,t,n){e.exports={"login-otp-verification":"_210lwq",username:"_2eL2SZ","input-container":"HSKgdN","input-wrapper":"_2EZ3Zp",input:"_1WRfas","resend-container":"uhuX5T",btn:"_3Vt3BV","submit-btn":"_14EHzR","white-btn":"_12-3-8"}},2735:function(e,t,n){e.exports={"login-widget":"_3wFoIb","left-container":"_3oBhRa",title:"_36KMOx",description:"_1-pxlW","login-img":"_4H6HH5","pull-right":"_2GmvEi","info-container":"_1bQ_eh","info-title":"syClp5","info-msg":"_1D_Icl","info-help-wrapper":"_2Hfijo","info-help-txt":"_3gZMG3","info-contact-btn":"jSDfcc","loader-icon":"o8qAfl","form-info":"_3tlxSp","form-success":"_18R4Qs","form-error":"_3ror51","info-desc":"_2B737C","input-action-txt":"_2_DUc_","form-view-container":"_36HLxm","verification-info-txt":"IVrJBP","success-otp":"_109n6g","prepend-txt":"_1_wZ0r","append-txt":"_2QKxJ-","form-btn-wrap":"_1D1L_j",loading:"aDGG69","terms-text":"_1Ijv5h","terms-color":"_2ARnXM","form-input-wrap":"_351hSN","form-input":"VJZDxU","submit-btn":"_2HKlqd","white-btn":"_3NgS1a","churn-email-info":"_22inUg",error:"_3kJtuq","churn-email-field":"_3LWExj","churned-icon":"_1KTVaP","login-otp-container":"_1k3JO2","login-otp-text":"_2XlkPA","loging-otp-signup":"_3B33Bm","login-new-user":"_1En5li"}},714:function(e,t,n){"use strict";n.r(t),n.d(t,"LoginSignupView",(function(){return Re}));var r=n(0),a=n(22),o=n(7),i=n.n(o),c=n(103),l=n.n(c),s=n(1),u=n.n(s),p=n(75),d=n(41),f=n(142),m=function(e){var t=e.styles,n=e.message,a=void 0===n?"":n,o=i()(t["submit-btn"],t["white-btn"],t["info-contact-btn"]);return r.createElement("div",{className:t["info-container"]},r.createElement("div",{className:t["info-title"]},r.createElement(d.a,{strKey:"loginVerificationBlockedTitle"})),r.createElement("div",{className:t["info-msg"]},a),r.createElement("div",{className:t["info-help-wrapper"]},r.createElement("div",{className:t["info-help-txt"]},r.createElement(d.a,{strKey:"loginVerificationBlockedHelpText"})),r.createElement(f.a,{external:!0,href:"/helpcentre",className:o},r.createElement(d.a,{strKey:"contactUs"}))))},g=n(495),h=n(11),b=n(102),y=n(158),v=n(228),O=n(194),w=n(86),E=n(36),S=n(196),_=n(30),N=n(74),I=n(68),P=n(190),T=n(176),x=n(334);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var a=A(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return L(this,n)}}function L(e,t){return!t||"object"!==C(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var K=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(c,e);var t,n,a,o=k(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).generateOTP=function(e){var n=t.state.mobileNumber,r=t.props,a=r.handleAPIRequest,o=r.handleAPIError,i=r.changeViewHandler,c=r.toast,l=r.compactView,s=Object(p.h)(n)?"+91".concat(n):n,u=l&&!e.signup,d=u?{loginId:s}:"loginId=".concat(s);a(u?O.d:O.c,d,(function(t){c.show(x.verificationCodeSentMsg,{userName:n}),i(u?{view:T.a.LOGIN,extra:Object.assign({userName:n,payload:t},e)}:{view:T.a.VERIFICATION,extra:Object.assign({userName:n,payload:t},e)})}),o,"new_otp_sent")},t.handleSubmit=function(e){e&&e.preventDefault();var n=t.state,r=n.mobileNumber,a=n.extra,o=t.props,i=o.handleAPIRequest,c=o.handleAPIError,l=o.changeViewHandler,s=o.compactView,d=o.trackOmniture,f=o.pageType,m=o.loginSource;if(t.validateAllFields()){var g=Object(p.h)(r)?"+91".concat(r):r;i(v.b,{loginId:[g],supportAllStates:!0},(function(e){var n=u()(e,["data","userDetails",g]);n===w.d||n===w.b?s&&Object(p.f)(r)?(d("email_signup",{pageType:f,loginSource:m}),l({view:T.a.SIGNUP,extra:{emailId:r}})):(d("mobile_signup",{pageType:f,loginSource:m}),t.generateOTP({signup:!0,emailId:a.emailId,accountState:n}),d("otp_requested",{pageType:f,loginSource:m})):s?(d("checkout_password_shown",{pageType:f,loginSource:m,loginId:Object(S.b)(r)}),n===w.c?c("loginDeactivatedUserNew"):n===w.a?c("loginChurnedUserNew"):(t.generateOTP({emailId:a.emailId,accountState:n}),l({view:T.a.LOGIN,extra:{userName:r}}))):(d("user_registered",{pageType:f,loginSource:m}),l({view:T.a.LOGIN,extra:{userName:r}}),c("loginRegisteredUserMsg"))}),(function(e){return c(e,"signup_failed")}),"signup_btn_clicked")}else d("invalid_email_mobile",{pageType:f,loginSource:m,loginId:Object(S.b)(r)});return!1},t.handleTextChange=function(e){var n=t.props,r=n.compactView,a=!n.extra.emailId&&r?e:e.replace(p.b,"");return t.setState({mobileNumber:Object(E.f)(a),invalidMobileNumber:""}),a},t.handleClick=function(e){var n=t.props,r=n.viewType,a=n.changeViewHandler;r!==w.q&&a({view:T.a.LOGIN,extra:{userName:t.state.mobileNumber}},e)},t.validateAllFields=function(){var e=t.state.mobileNumber,n=t.props,a=n.compactView,o=n.extra;if(a&&!o.emailId){var i=Object(p.c)(e)?Object(p.h)(e):Object(p.f)(e);return!i&&t.setState({invalidMobileNumber:r.createElement(h.a,{strKey:"loginInvalidUserName"})}),i}return!!Object(p.h)(e)||(t.setState({invalidMobileNumber:r.createElement(h.a,{strKey:"loginInvalidMobileNumber"})}),!1)},t.handleOnFocus=function(){var e=t.props,n=e.showModal,r=e.toast,a=e.makeLoginRequest,o=e.compactView,i=e.viewType,c=e.handleLoginSuccess,l=e.pageType;if(0===t.count&&o&&l===w.n){var s={showModal:n,toast:r,makeLoginRequest:a,omnitureData:{source:"checkout",page:"checkout"},view:i,handleLoginSuccess:c};Object(P.b)(s),t.count++}},t.handleEmailIdChange=function(e){e&&e.preventDefault(),(0,t.props.changeViewHandler)({view:T.a.SIGNUP,extra:{}})},t.state={mobileNumber:u()(e,"extra.mobileNumber",""),extra:e.extra},t.count=0,t}return t=c,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.setState({mobileNumber:u()(e,"extra.mobileNumber",""),extra:e.extra||{},invalidMobileNumber:""})}},{key:"render",value:function(){var e=this.state,t=e.invalidMobileNumber,n=e.mobileNumber,a=e.extra,o=u()(a,["emailId"]),c=this.props,l=c.styles,s=c.compactView,d=s&&!o?Object(p.h)(n):!!n,m=s&&!o?"loginPlaceHolderUserName":"loginPlaceHolderMobile";return r.createElement("form",{onSubmit:this.handleSubmit},o&&r.createElement("div",null,r.createElement(g.a,{value:o,readOnly:!0,appendInfo:!0,className:l["form-input"],wrapperClass:l["form-input-wrap"]},r.createElement("a",{href:"javascript:void(0);",className:i()(l["append-txt"],l["input-action-txt"]),onClick:this.handleEmailIdChange,tabIndex:-1},r.createElement(h.a,{strKey:"loginChangeUserNameTxt"})))),r.createElement(g.a,{maxLength:s&&!o?"auto":10,value:n,captureAutoFill:!0,prependInfo:d,errorMsg:t,autoFocus:!s,tabIndex:"1",onFocus:this.handleOnFocus,placeholder:r.createElement(h.a,{strKey:m}),onTextChange:this.handleTextChange,className:l["form-input"],wrapperClass:l["form-input-wrap"]},d?r.createElement("span",{className:l["prepend-txt"]},"+91"):null),r.createElement("div",{className:l["terms-text"]},"By continuing, you agree to Flipkart's"," ",r.createElement(_.a,{to:"/pages/terms",className:l["terms-color"],target:"_blank"},"Terms of Use")," ","and"," ",r.createElement(_.a,{to:"/pages/privacypolicy",className:l["terms-color"],target:"_blank"},"Privacy Policy"),"."),r.createElement("div",{className:l["form-btn-wrap"]},r.createElement(f.a,{type:"submit",secondary:!0,className:l["submit-btn"]},r.createElement(b.a,{stroke:"#fff",className:l["loader-icon"]}),r.createElement(h.a,{strKey:"continueText"})),!s&&r.createElement(f.a,{href:w.s,className:i()(l["submit-btn"],l["white-btn"],l["change-view-btn"]),onClick:this.handleClick},r.createElement(h.a,{strKey:"loginAlreadyHaveAccountBtnMsg"}))))}}])&&j(t.prototype,n),a&&j(t,a),c}(r.Component);K.defaultProps={extra:{},trackOmniture:function(){return null}};var U={showModal:I.d,makeLoginRequest:y.b},B=Object(a.b)(null,U)(Object(N.d)(K)),D=n(397),G=n(246),M=n(624),V=n(50);function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=J(e);if(t){var a=J(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Z(this,n)}}function Z(e,t){return!t||"object"!==q(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function J(e){return(J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(c,e);var t,n,a,o=W(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).onTextChange=function(e){t.setState(e)},t.validateAllFields=function(){var e=t.state,n=e.userName,a=e.password,o=!0,i=Object(p.c)(n),c=t.props,l=c.pageType,s=c.loginSource;return i&&!Object(p.h)(n)||!i&&!Object(p.f)(n)?(t.props.trackOmniture((n||"").length>0?"invalid_email_mobile":"",{pageType:l,loginSource:s,loginId:Object(S.b)(n)}),t.setState({credentialError:r.createElement(h.a,{strKey:"loginInvalidUserName"})}),o=!1):a||(t.props.trackOmniture("empty_pwd",{pageType:l,loginSource:s,loginId:Object(S.b)(n)}),t.setState({invalidPassword:r.createElement(h.a,{strKey:"loginInvalidPassword"})}),o=!1),o},t.generateOTP=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"otp_sent",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=t.state.userName,i=t.submitContainer,c=n.isLoginwithOTP,l=t.props,s=l.handleAPIRequest,d=l.changeViewHandler,f=l.toast,m=l.handleAPIError,g=l.styles,h=Object(p.h)(o)?"+91".concat(o):o,b=c?{loginId:h}:"loginId=".concat(h,"&state=").concat(e,"&churnEmailRequest=").concat(a);s(c?O.d:O.c,b,(function(l){if(e!==w.a||a||t.generateOTP(e,{mobilePayload:l,churned:!0},r,!0),c&&!n.churned){var s=u()(l,"data.requestId");d({view:T.a.LOGIN_WITH_OTP,extra:{userName:o,loginWithOTPRequestId:s}})}else Object(G.e)(i,g.loading),d({view:T.a.VERIFICATION,extra:Object.assign({userName:o,payload:l,accountState:e,reactivate:e===w.c},n)});n.churned?f.show(x.verificationCodeSentToAllMsg,{userName:o,email:u()(l,["data","emailMask"])}):e!==w.a&&f.show(x.verificationCodeSentMsg,{userName:o})}),(function(e){var n,r=e;if((null===(n=null==r?void 0:r.error)||void 0===n?void 0:n.ERROR_CODE)!==V.b){if(c)r={error:{RESPONSE:{errorCode:u()(e,"error.errorCode"),message:u()(e,"error.message")}}};var a=u()(r,"error.RESPONSE.errorCode"),o=u()(r,"error.RESPONSE.message");return"LOGIN_1004"===a?d({view:T.a.MESSAGE_INFO,extra:{message:o}}):m(r)}var i=null==r?void 0:r.error;t.setState({challengeData:{appId:null==i?void 0:i.appId,jsClientSrc:null==i?void 0:i.jsClientSrc,vid:null==i?void 0:i.vid,uuid:null==i?void 0:i.uuid,blockScript:null==i?void 0:i.blockScript,flowName:"login"},showChallenge:!0})}),r,"",h)},t.onForgotPasswordClick=function(e,n){n&&n.preventDefault();var r=t.props,a=r.handleAPIRequest,o=r.handleAPIError,i=r.trackOmniture,c=r.pageType,l=r.loginSource,s=Object(p.h)(e)?"+91".concat(e):e;return a(v.b,{loginId:[s],supportAllStates:!0},(function(n){var r=u()(n,["data","userDetails",s],"");r===w.d||r===w.b?o("loginUnregisteredUserMsg"):(i("forgot_btn_clicked",{pageType:c,loginSource:l,loginId:Object(S.b)(e)}),t.generateOTP(r))}),o),!1},t.submitContainerRef=function(e){t.submitContainer=e},t.handleChangeUserNameClick=function(){(0,t.props.changeViewHandler)({view:T.a.SIGNUP,extra:{}})},t.handleSubmit=function(e){var n=t.state,a=n.userName,o=n.password,i=n.reactivate,c=t.props,l=c.handleAPIRequest,s=c.handleAPIError,d=c.changeViewHandler,f=c.styles,m=c.handleLoginSuccess,g=c.trackOmniture,b=c.pageType,v=c.loginSource,O=t.submitContainer,E=Object(p.h)(a)?w.p.MOBILE_PASSWORD:w.p.EMAIL_PASSWORD;return t.validateAllFields()&&(Object(p.h)(a)?g("login_mobile_entered",{pageType:b,loginSource:v}):g("login_email_entered",{pageType:b,loginSource:v}),Object(G.a)(O,f.loading),l(i?D.b:y.b,{loginId:Object(p.h)(a)?"+91".concat(a):a,password:o},(function(){Object(G.e)(O,f.loading),l(I.c),"function"==typeof m&&m(E)}),(function(e){Object(G.e)(O,f.loading);var n=u()(e,["error","RESPONSE","errorCode"]);if("LOGIN_1039"===n)d({view:T.a.SIGNUP,extra:{oldUserName:a,churned:!0}});else{if("LOGIN_1032"===n)return d({view:T.a.LOGIN,extra:{userName:a,password:o,disableOTPButton:!0,reactivate:!0}}),g("login_deactivated_user",{pageType:b,loginSource:v}),t.setState({reactivate:!0,credentialError:""});if("MAPI_0017"===n)return t.generateOTP(w.e,{password:o,unverified:!0},"new_otp_sent"),null;if("LOGIN_1003"===n)g("account_not_exists",{pageType:b,loginSource:v,loginId:Object(S.b)(a)}),d({view:T.a.SIGNUP,extra:{mobileNumber:Object(p.h)(a)?a:""}}),e="loginUnregisteredUserMsg";else{if("LOGIN_1012"===n)return g("invalid_login_details",{pageType:b,loginSource:v,loginId:Object(S.b)(a)}),t.setState({credentialError:r.createElement(h.a,{strKey:"loginInvalidCredentials"})}),null;"MAPI_0004"===n?"function"==typeof m&&m(E):"LOGIN_1011"===n?g("invalid_email_mobile",{pageType:b,loginSource:v,loginId:Object(S.b)(a)}):g("login_failed",{pageType:b,loginSource:v})}}return s(e)}),"login_success")),e&&e.preventDefault(),!1},t.handleLoginWithOTP=function(e){e&&e.preventDefault();var n=t.state,a=n.userName,o=n.password,i=t.props,c=i.pageType,l=i.loginSource,s=i.handleAPIRequest,d=i.changeViewHandler,f=i.handleAPIError,m=i.trackOmniture,g=Object(p.c)(a);if(g&&!Object(p.h)(a)||!g&&!Object(p.f)(a))t.props.trackOmniture((a||"").length>0?"invalid_email_mobile":"",{pageType:c,loginSource:l,loginId:Object(S.b)(a)}),t.setState({credentialError:r.createElement(h.a,{strKey:"loginInvalidUserName"})});else{var b=Object(p.h)(a)?"+91".concat(a):a;s(v.b,{loginId:[b],supportAllStates:!0},(function(e){var n=u()(e,["data","userDetails",b],"");if(n===w.d||n===w.b)d({view:T.a.SIGNUP,extra:{mobileNumber:Object(p.h)(a)?a:""}}),f("loginUnregisteredUserMsg");else if(n===w.a)d({view:T.a.LOGIN,extra:{userName:Object(p.h)(a)?a:"",disableOTPButton:!0}}),t.props.enableLoginPassword?f("loginChurnedUser"):f("loginChurnedUserNew");else{if(n===w.c)return d({view:T.a.LOGIN,extra:{userName:a,password:o,reactivate:!0,disableOTPButton:!0}}),m("login_deactivated_user",{pageType:c,loginSource:l}),t.props.enableLoginPassword?f("loginDeactivatedUser"):f("loginDeactivatedUserNew"),t.setState({reactivate:!0,credentialError:""});t.generateOTP(n,{isLoginwithOTP:!0},"login_otp_sent")}}),(function(e){return f(e,"login_failed")}),"otp_request_btn_clicked")}},t.handleUserNameChange=function(e){return t.onTextChange({userName:(e||"").trim(),credentialError:""})},t.handlePasswordChange=function(e){return t.onTextChange({password:e,invalidPassword:""})},t.handleBtnCLick=function(e){t.props.viewType!==w.q&&t.props.changeViewHandler({view:T.a.SIGNUP},e)},t.handleReactivateClick=function(e,n){return function(a){a.preventDefault();var o=t.props,i=o.pageType,c=o.loginSource,l=n?Object(p.h)(e):Object(p.f)(e);return e&&l?t.onForgotPasswordClick(e,a):(t.props.trackOmniture((e||"").length>0?"invalid_email_mobile":"",{pageType:i,loginSource:c,loginId:Object(S.b)(e)}),t.setState({credentialError:r.createElement(h.a,{strKey:"loginInvalidUserName"})}),!1)}},t._onChallengeSuccess=function(){t.handleLoginWithOTP(),t.setState({showChallenge:!1})},t.state={userName:u()(e,["extra","userName"])||"",password:u()(e,["extra","password"])||"",reactivate:u()(e,["extra","reactivate"])||!1,disableOTPButton:u()(e,["extra","disableOTPButton"])||!1},t}return t=c,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){u()(e,["extra","userName"])?this.setState({userName:e.extra.userName,reactivate:!1}):this.setState({userName:"",password:"",credentialError:"",invalidPassword:"",reactivate:!1})}},{key:"render",value:function(){var e,t,n,a=this.state,o=a.userName,c=a.credentialError,l=a.invalidPassword,s=a.password,u=a.reactivate,d=this.props,m=d.extra,y=d.styles,v=d.compactView,O=d.enableLoginPassword,E=Object(p.c)(o),S=/^\d{1,10}$/.test(o);return r.createElement("form",{key:"loginForm",onSubmit:this.handleSubmit,autoComplete:"on"},r.createElement(g.a,{captureAutoFill:!0,autoFocus:!v,prependInfo:S,value:o,readOnly:u||v,errorMsg:c,placeholder:r.createElement(h.a,{strKey:"loginPlaceHolderUserName"}),onTextChange:this.handleUserNameChange,className:y["form-input"],wrapperClass:i()(y["form-input-wrap"],(e={},t=y["has-error"],n=!!c,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),appendInfo:v},S?r.createElement("span",{className:y["prepend-txt"]},"+91"):null,v?r.createElement("a",{className:i()(y["append-txt"],y["input-action-txt"]),onClick:this.handleChangeUserNameClick,tabIndex:-1},r.createElement(h.a,{strKey:"loginChangeUserNameTxt"})):null),O?r.createElement(g.a,{captureAutoFill:!0,type:"password",autoFocus:v,value:s,errorMsg:l,placeholder:r.createElement(h.a,{strKey:"loginPlaceHolderPassword"}),appendInfo:"true",onTextChange:this.handlePasswordChange,className:y["form-input"],wrapperClass:y["form-input-wrap"]},u?null:r.createElement("a",{className:i()(y["append-txt"],y["input-action-txt"]),onClick:this.handleReactivateClick(o,E),tabIndex:-1},r.createElement(h.a,{strKey:"loginForgotTxt"}))):null,r.createElement("div",{className:y["terms-text"]},"By continuing, you agree to Flipkart's"," ",r.createElement(_.a,{to:"/pages/terms",className:y["terms-color"],target:"_blank"},"Terms of Use")," ","and"," ",r.createElement(_.a,{to:"/pages/privacypolicy",className:y["terms-color"],target:"_blank"},"Privacy Policy"),"."),O?r.createElement("div",{ref:this.submitContainerRef,className:y["form-btn-wrap"]},r.createElement(f.a,{type:"submit",secondary:!0,className:y["submit-btn"]},r.createElement(b.a,{stroke:"#fff",className:y["loader-icon"]}),r.createElement(h.a,{strKey:u?"loginReactivateBtnTxt":"loginTitleTxt"}))):null,!m.disableOTPButton&&!v&&!u&&r.createElement("div",{className:y["login-otp-container"]},O?r.createElement("div",{className:y["login-otp-text"]},Object(h.d)("or")):null,this.state.challengeData&&this.state.showChallenge?r.createElement(M.a,{onSuccess:this._onChallengeSuccess,data:this.state.challengeData,dataKey:"pxLoginOtp"}):O?r.createElement(f.a,{className:i()(y["submit-btn"],y["white-btn"]),onClick:this.handleLoginWithOTP},Object(h.d)("loginOTPTitle")):r.createElement(f.a,{secondary:!0,className:y["submit-btn"],onClick:this.handleLoginWithOTP},Object(h.d)("loginOTPTitle"))),u||v?null:r.createElement("div",{className:y["login-new-user"]},r.createElement(f.a,{link:!0,href:w.t,onClick:this.handleBtnCLick},Object(h.d)("loginWithOTPNewUser"))))}}])&&F(t.prototype,n),a&&F(t,a),c}(r.Component);$.defaultProps={extra:{},trackOmniture:function(){return null}};var Q=n(368);function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t){return(Y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ee(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ne(e);if(t){var a=ne(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return te(this,n)}}function te(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Y(e,t)}(c,e);var t,n,a,o=ee(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).onTextChange=function(e){t.setState(e)},t.handleChangeUserNameClick=function(){(0,t.props.changeViewHandler)({view:T.a.SIGNUP,extra:{}})},t.handleOTPChange=function(e){t.onTextChange({otp:e})},t.handleResendOTP=function(){var e=t.props,n=e.handleAPIRequest,r=e.toast,a=e.changeViewHandler,o=e.handleAPIError,i=u()(t.props,"extra.userName",""),c={loginId:Object(p.h)(i)?"+91".concat(i):i};n(O.d,c,(function(e){var n=u()(e,"data.requestId","");t.setState({loginWithOTPreqId:n}),r.show(x.verificationCodeSentMsg,{userName:i})}),(function(e){return"LOGIN_1004"===u()(e,["error","RESPONSE","errorCode"])?a({view:T.a.MESSAGE_INFO,extra:{message:e.error.RESPONSE.message}}):o(e)}),"loginwith_resend_otp_clicked","",i)},t.renderResendBtn=function(){var e=t.props.styles;return r.createElement("a",{href:"#",className:i()(e["input-action-txt"],e["append-txt"]),onClick:t.handleResendOTP,tabIndex:-1},r.createElement(h.a,{strKey:"loginResendOtpText"}))},t.renderOTPInput=function(){var e=t.props,n=e.compactView,a=e.styles,o=t.state.otp;return r.createElement(g.a,{onTextChange:t.handleOTPChange,placeholder:r.createElement(h.a,{strKey:"loginOTPPlaceholder"}),pattern:p.a,autoComplete:"on",autoFocus:!0,maxLength:"6",value:o,appendInfo:n,className:a["form-input"],wrapperClass:a["form-input-wrap"]},t.renderResendBtn())},t.handleLoginOTPSubmit=function(e){e&&e.preventDefault();var n=t.props,r=n.handleAPIRequest,a=n.handleAPIError,o=n.handleLoginSuccess,i=n.trackOmniture,c=n.pageType,l=n.loginSource,s=n.changeViewHandler,d=u()(t.state,"userName",""),f={userId:Object(p.h)(d)?"+91".concat(d):d,requestId:u()(t.state,"loginWithOTPreqId")||u()(t.props,"extra.payload.data.requestId"),otp:t.state.otp||""},m=Object(p.h)(d)?w.p.MOBILE_OTP:w.p.EMAIL_OTP;i("loginwith_otp_entered",{pageType:c,loginSource:l,loginId:Object(S.b)(d)}),r(Q.b,f,(function(){"function"==typeof o&&o(m)}),(function(e){var t=u()(e,"error.errorCode"),n={error:{RESPONSE:{errorCode:t,message:u()(e,"error.message")}}};return"LOGIN_1011"===t?i("invalid_email_mobile",{pageType:c,loginSource:l,loginId:Object(S.b)(d)}):"LOGIN_1032"===t?(s({view:T.a.LOGIN,extra:{userName:d,reactivate:!0}}),i("login_deactivated_user",{pageType:c,loginSource:l})):"MAPI_0004"===t?"function"==typeof o&&o(m):"LOGIN_1008"===t?i("loginwith_otp_incorrect",{pageType:c,loginSource:l,loginId:Object(S.b)(d)}):(s({view:T.a.LOGIN,extra:{userName:d}}),i("login_failed",{pageType:c,loginSource:l})),a(n)}),"login_otp_success","",d)},t.state={userName:u()(e,["extra","userName"])||"",reactivate:u()(e,["extra","reactivate"])||!1,loginWithOTPreqId:u()(e,"extra.payload.data.requestId")},t}return t=c,(n=[{key:"UNSAFE_componentWillReceiveProps",value:function(e){u()(e,["extra","userName"])?this.setState({userName:e.extra.userName,reactivate:!1}):this.setState({userName:"",credentialError:"",reactivate:!1})}},{key:"render",value:function(){var e,t,n,a=this.state,o=a.userName,c=a.credentialError,l=a.reactivate,s=this.props,u=s.styles,p=s.compactView,d=/^\d{1,10}$/.test(o);return r.createElement("form",{key:"loginForm",onSubmit:this.handleLoginOTPSubmit,autoComplete:"on"},r.createElement(g.a,{captureAutoFill:!0,autoFocus:!p,prependInfo:d,value:o,readOnly:l||p,errorMsg:c,placeholder:r.createElement(h.a,{strKey:"loginPlaceHolderUserName"}),className:u["form-input"],wrapperClass:i()(u["form-input-wrap"],(e={},t=u["has-error"],n=!!c,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e)),appendInfo:p},d?r.createElement("span",{className:u["prepend-txt"]},"+91"):null,r.createElement("a",{className:i()(u["append-txt"],u["input-action-txt"]),onClick:this.handleChangeUserNameClick,tabIndex:-1},r.createElement(h.a,{strKey:"loginChangeUserNameTxt"}))),this.renderOTPInput(),r.createElement("div",{className:u["terms-text"]},"By continuing, you agree to Flipkart's"," ",r.createElement(_.a,{to:"/pages/terms",className:u["terms-color"],target:"_blank"},"Terms of Use")," ","and"," ",r.createElement(_.a,{to:"/pages/privacypolicy",className:u["terms-color"],target:"_blank"},"Privacy Policy"),"."),r.createElement("div",{className:u["form-btn-wrap"]},r.createElement(f.a,{type:"submit",secondary:!0,className:u["submit-btn"]},r.createElement(b.a,{stroke:"#fff",className:u["loader-icon"]}),r.createElement(h.a,{strKey:l?"loginReactivateBtnTxt":"loginTitleTxt"}))))}}])&&z(t.prototype,n),a&&z(t,a),c}(r.Component);re.defaultProps={extra:{},trackOmniture:function(){return null}};var ae=n(153),oe=n(396),ie=n(25);function ce(e){return(ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ue(e,t){return(ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fe(e);if(t){var a=fe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return de(this,n)}}function de(e,t){return!t||"object"!==ce(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ue(e,t)}(c,e);var t,n,a,o=pe(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).onTextChange=function(e){t.setState(e)},t.handleOTPChange=function(e){var n=e.payloadKey,a=void 0===n?"payload":n,o=e.valueKey,i=void 0===o?"verificationCode":o,c=e.otpErrorKey,l=void 0===c?"otpError":c,s=e.verifiedState,f=void 0===s?"verified":s,m=e.churnEmailRequest;return function(e){var n,o=t.props,c=o.extra,s=o.changeViewHandler,g=o.trackOmniture,h=o.pageType,b=o.loginSource,y=o.handleAPIRequest,v=o.handleAPIError,O=t.state[i],w=u()(c,[a,"data","requestId"],""),E=u()(c,[a,"data","otpRegex"],""),_=new RegExp("".concat(E,"$"),"g");if(w&&O!==e&&_.test(e)){var N=Object(p.h)(c.userName)?"+91".concat(c.userName):c.userName;++t.count,O&&g(c.signup?"otp_entered_signup":"otp_entered_login",{pageType:h,loginSource:b,loginId:Object(S.b)(u()(c,"userName"))}),y(Q.a,{otp:e,otpRequestId:w,loginId:N,churnEmailRequest:m},(function(){var e;t.count=0,t.setState((le(e={},f,!0),le(e,l,""),e))}),(function(e){g(c.signup?"new_otp_verification_failed":"otp_verification_failed",{pageType:h,loginSource:b,loginId:Object(S.b)(u()(c,"userName")),attempt:t.count});var n=u()(e,["error","RESPONSE","errorCode"]);return"LOGIN_1008"===n?t.setState(le({},l,e.error.RESPONSE.message)):"LOGIN_1006"===n?s({view:T.a.MESSAGE_INFO,extra:{message:e.error.RESPONSE.message}}):"LOGIN_1007"===n?t.setState(le({},l,r.createElement(d.a,{strKey:"loginOTPExpiredErrorMsg"}))):v(e)}),c.signup?"signup_otp_verified":"otp_verified")}t.onTextChange((le(n={},i,e),le(n,l,""),n))}},t.handleSubmit=function(e){if(e&&e.preventDefault(),!t.validateAllFields())return!1;var n=t.props,a=n.extra,o=void 0===a?{}:a,i=n.styles,c=n.handleLoginSuccess,l=n.trackOmniture,s=n.pageType,f=n.loginSource,m=n.handleAPIRequest,g=n.handleAPIError,h=t.state,b=h.verificationCode,y=h.emailVerificationCode,O=h.password,E=t.submitContainer,_=u()(o,"payload.data.requestId","");Object(G.a)(E,i.loading);var N=Object(p.h)(o.userName)?"+91".concat(o.userName):o.userName,P={loginId:N,otp:b,password:o.unverified?o.password:O,otpRequestId:_},T=oe.b;return o.signup?(T=v.a,P.emailId=o.emailId):o.unverified?T=ae.d:o.churned&&(P.otpRequestId=u()(o,["mobilePayload","data","requestId"]),P.emailOtpRequestId=u()(o,["payload","data","requestId"]),P.emailOtp=y),m(T,P,(function(){m(I.c),"function"==typeof c&&c(w.p.EMAIL_PASSWORD)}),(function(e){Object(G.e)(E,i.loading);var n=u()(e,["error","RESPONSE","errorCode"]);return"LOGIN_1009"===n?t.setState({passwordError:e.error.RESPONSE.message}):"LOGIN_1062"===n?(l("loginverify_same_password",{pageType:s,loginSource:f,loginId:Object(S.b)(N)}),g(e,"")):"LOGIN_1007"===n?(l("loginverify_otp_expired",{pageType:s,loginSource:f,loginId:Object(S.b)(N)}),t.setState({otpError:r.createElement(d.a,{strKey:"loginOTPExpiredErrorMsg"})})):g(e,o.signup?"signup_failed":"login_failed")}),o.signup?"signup_success":"reset_pwd_success"),!1},t.handleRegenerateOTP=function(e){var n=e.churnEmailRequest,r=void 0!==n&&n,a=e.payloadKey,o=void 0===a?"payload":a,i=e.valueKey,c=void 0===i?"verificationCode":i,l=e.otpErrorKey,s=void 0===l?"otpError":l,d=e.verifiedState,f=void 0===d?"verified":d;return function(e){e&&e.preventDefault();var n=t.props,a=n.changeViewHandler,i=n.extra,l=n.toast,d=n.trackOmniture,m=n.pageType,g=n.loginSource,h=n.handleAPIRequest,b=n.handleAPIError,y=i.userName,v=i.accountState;t.count=0,d(i.signup?"signup_resend_otp_clicked":"resend_otp_clicked",{pageType:m,loginSource:g,loginId:Object(S.b)(y)});var w=Object(p.h)(y)?"+91".concat(y):y,E="loginId=".concat(w,"&state=").concat(v,"&churnEmailRequest=").concat(r);h(O.c,E,(function(e){var n;return r?l.show(x.verificationCodeSentMsg,{userName:u()(e,["data","emailMask"])}):l.show(x.verificationCodeSentMsg,{userName:y}),t.setState((le(n={},f,!1),le(n,s,""),le(n,"passwordError",""),le(n,c,""),n)),a({view:T.a.VERIFICATION,extra:Object.assign({},i,le({},o,e))})}),b,i.signup?"new_otp_sent":"otp_sent","",w),e.preventDefault()}},t.submitContainerRef=function(e){t.submitContainer=e},t.handleBtnClick=function(e){return t.props.changeViewHandler({view:u()(t.props,["extra","signup"])?T.a.LOGIN:T.a.SIGNUP,extra:{}},e)},t.handleChangeUserNameClick=function(e){e.preventDefault();var n=t.props,r=n.compactView;(0,n.changeViewHandler)({view:u()(t.props,["extra","signup"])||r?T.a.SIGNUP:T.a.LOGIN,extra:{}})},t.handleUserNameChange=function(e){return e.replace(/\D+/g,"")},t.handlePasswordChange=function(e){return t.onTextChange({password:e,passwordError:""})},t.renderResendBtn=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.props,o=a.compactView,c=a.styles;return r.createElement("a",{href:"#",className:i()(c["input-action-txt"],le({},c["pull-right"],!o&&!e),le({},c["append-txt"],o||e)),onClick:t.handleRegenerateOTP(n),tabIndex:-1},r.createElement(d.a,{strKey:"loginResendOtpText"}))},t.renderOTPInputField=function(e){var n=e.payloadKey,a=e.verifiedState,o=void 0===a?"verified":a,c=e.churnEmailRequest,l=e.placeholderKey,s=void 0===l?"loginOTPPlaceholder":l,u=e.valueKey,f=void 0===u?"verificationCode":u,m=e.otpErrorKey,h=void 0===m?"otpError":m,b=e.churned,y=e.wrapperClass,v=e.autoFocus,O=void 0===v||v,w=t.props,E=w.compactView,S=w.styles,_=t.state,N=_[f],I=_[h],P=_[o];return r.createElement(g.a,{onTextChange:t.handleOTPChange({valueKey:f,otpErrorKey:h,payloadKey:n,verifiedState:o,churnEmailRequest:c}),placeholder:r.createElement(d.a,{strKey:s}),pattern:p.a,autoComplete:"on",autoFocus:O,maxLength:"6",value:N,readOnly:P,errorMsg:I,appendInfo:E||b||P,className:S["form-input"],wrapperClass:i()(y,S["form-input-wrap"])},P?r.createElement("span",{className:i()(S["success-otp"],S["append-txt"])},r.createElement(ie.O,null)):E||b?t.renderResendBtn(b,{churnEmailRequest:c,payloadKey:n,valueKey:f,otpErrorKey:h,verifiedState:o}):null)},t.validateAllFields=function(){var e=!0,n=t.props,a=n.extra,o=n.trackOmniture,i=n.pageType,c=n.loginSource,l=n.enableSignupPassword,s=t.state,p=s.verificationCode,f=s.emailVerificationCode,m=s.password,g=s.verified,h=s.emailVerified;return p&&g?!a.churned||f&&h||(t.setState({emailOtpError:r.createElement(d.a,{strKey:"loginInvalidOTP"})}),e=!1,o("otp_verification_failed_other",{pageType:i,loginSource:c,loginId:Object(S.b)(u()(a,"userName"))})):(t.setState({otpError:r.createElement(d.a,{strKey:"loginInvalidOTP"})}),e=!1,o("otp_verification_failed_other",{pageType:i,loginSource:c,loginId:Object(S.b)(u()(a,"userName"))})),l&&(a.unverified||m||(t.setState({passwordError:r.createElement(d.a,{strKey:"loginInvalidPassword"})}),e=!1)),e},t.count=0,t.state={verified:!1,password:"",mobileNumber:"",otpError:"",passwordError:"",verificationCode:""},t}return t=c,(n=[{key:"render",value:function(){var e=this.props,t=e.extra,n=e.styles,a=e.compactView,o=e.enableSignupPassword,c=Object(p.c)(t?t.userName:""),l=u()(t,["payload","data","emailMask"],""),s=this.state,m=s.password,h=s.passwordError,y=s.emailOtpError,v=t.churned,O=v?"mobilePayload":"payload",w="loginTitleTxt";return t.signup?w="signupBtnTxt":t.unverified?w="loginVerifyBtnTxt":t.reactivate&&(w="loginReactivateBtnTxt"),r.createElement("form",{onSubmit:this.handleSubmit},r.createElement(g.a,{readOnly:!0,prependInfo:c,autoComplete:"username",value:t.userName||"",appendInfo:"true",onTextChange:this.handleUserNameChange,placeholder:r.createElement(d.a,{strKey:c?"loginVerificationMobilePlaceholderTxt":"loginVerificationEmailPlaceholderTxt"}),className:n["form-input"],wrapperClass:n["form-input-wrap"]},c?r.createElement("span",{className:n["prepend-txt"]},"+91"):null,r.createElement("a",{href:"#",className:i()(n["append-txt"],n["input-action-txt"]),onClick:this.handleChangeUserNameClick,tabIndex:-1},r.createElement(d.a,{strKey:"loginChangeUserNameTxt"}))),a||v?null:r.createElement("div",{className:n["verification-info-txt"]},r.createElement(d.a,{strKey:c?"loginOTPSentToMobileMsg":"loginOTPSentToEmailMsg"}),this.renderResendBtn()),this.renderOTPInputField(Object.assign({payloadKey:O,churned:v},v&&{placeholderKey:"loginMobileOTPPlaceholder"})),v&&r.createElement("div",null,this.renderOTPInputField({churnEmailRequest:!0,autoFocus:!1,verifiedState:"emailVerified",valueKey:"emailVerificationCode",otpErrorKey:"emailOtpError",placeholderKey:"loginEmailOTPPlaceholder",wrapperClass:n["churn-email-field"],churned:v}),r.createElement(d.a,{className:i()(n["churn-email-info"],le({},n.error,!!y)),strKey:"loginEmailOTPInfoTxt",attributes:{email:l}})),o?t.unverified?null:r.createElement(g.a,{type:"password",value:m,onTextChange:this.handlePasswordChange,errorMsg:h,className:n["form-input"],wrapperClass:n["form-input-wrap"],placeholder:r.createElement(d.a,{strKey:"loginSetPasswordPlaceholder"})}):null,r.createElement("div",{ref:this.submitContainerRef,className:n["form-btn-wrap"]},r.createElement(f.a,{type:"submit",secondary:!0,className:n["submit-btn"]},r.createElement(b.a,{stroke:"#fff",className:n["loader-icon"]}),r.createElement(d.a,{strKey:w})),t.unverified||t.reactivate||a?null:r.createElement(f.a,{className:i()(n["submit-btn"],n["white-btn"],n["change-view-btn"]),onClick:this.handleBtnClick},t.signup?r.createElement(d.a,{strKey:"loginAlreadyHaveAccountBtnMsg"}):r.createElement(d.a,{strKey:"loginNewUserBtnMsg"}))))}}])&&se(t.prototype,n),a&&se(t,a),c}(r.Component);me.defaultProps={extra:{payload:{data:{}}},trackOmniture:function(){return null}};var ge=n(1371);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=we(e);if(t){var a=we(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Oe(this,n)}}function Oe(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(i,e);var t,n,a,o=ve(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleOTPSubmit=function(e){var n=t.props,r=n.handleAPIRequest,a=n.handleAPIError,o=n.handleLoginSuccess,i=n.extra,c=n.trackOmniture,l=n.pageType,s=n.loginSource,d=n.changeViewHandler,f=u()(i,"userName",""),m={userId:Object(p.h)(f)?"+91".concat(f):f,requestId:u()(t.state,"requestId"),otp:e},g=Object(p.h)(f)?w.p.MOBILE_OTP:w.p.EMAIL_OTP;c("loginwith_otp_entered",{pageType:l,loginSource:s,loginId:Object(S.b)(f)}),r(Q.b,m,(function(){r(I.c),"function"==typeof o&&o(g)}),(function(e){var t=u()(e,"error.errorCode"),n={error:{RESPONSE:{errorCode:t,message:u()(e,"error.message")}}};return"LOGIN_1011"===t?c("invalid_email_mobile",{pageType:l,loginSource:s,loginId:Object(S.b)(f)}):"LOGIN_1032"===t?(d({view:T.a.LOGIN,extra:{userName:f,reactivate:!0}}),c("login_deactivated_user",{pageType:l,loginSource:s})):"MAPI_0004"===t?"function"==typeof o&&o(g):"LOGIN_1008"===t?c("loginwith_otp_incorrect",{pageType:l,loginSource:s,loginId:Object(S.b)(f)}):(d({view:T.a.LOGIN,extra:{userName:f}}),c("login_failed",{pageType:l,loginSource:s})),a(n)}),"login_otp_success","",f)},t.handleResendOTP=function(){var e=t.props,n=e.handleAPIRequest,r=e.toast,a=e.changeViewHandler,o=e.handleAPIError,i=u()(t.props,"extra.userName",""),c={loginId:Object(p.h)(i)?"+91".concat(i):i};n(O.d,c,(function(e){var n=u()(e,"data.requestId","");t.setState({requestId:n}),r.show(x.verificationCodeSentMsg,{userName:i})}),(function(e){return"LOGIN_1004"===u()(e,["error","RESPONSE","errorCode"])?a({view:T.a.MESSAGE_INFO,extra:{message:e.error.RESPONSE.message}}):o(e)}),"loginwith_resend_otp_clicked","",i)},t.handleEditClick=function(e){var n=t.props,r=n.changeViewHandler,a=n.extra,o=(void 0===a?{}:a).userName;r({view:T.a.LOGIN,extra:{userName:o}},e)},t.handleChangeInOTP=function(e){if(e){var n=e.join("");ge.a.test(n)&&t.handleOTPSubmit(n)}},t.state={requestId:u()(e,"extra.loginWithOTPRequestId","")},t}return t=i,(n=[{key:"render",value:function(){var e=this.props.extra,t=(void 0===e?{}:e).userName,n=void 0===t?"":t;return r.createElement(r.Fragment,null,r.createElement(ge.b,{userName:n,handleOTPSubmit:this.handleOTPSubmit,handleResendOTP:this.handleResendOTP,handleEdit:this.handleEditClick,handleChangeInOTP:this.handleChangeInOTP,showEditButton:!0}))}}])&&be(t.prototype,n),a&&be(t,a),i}(r.Component),Se=n(19),_e=n(2735),Ne=n.n(_e);function Ie(e){return(Ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Te(e,t){return(Te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=je(e);if(t){var a=je(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ce(this,n)}}function Ce(e,t){return!t||"object"!==Ie(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Te(e,t)}(c,e);var t,n,a,o=xe(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=o.call(this,e)).trackFDP=function(e){Se.a.trackEvent({en:"LRE",erc:e.errorCode,iss:e.isSuccess,lid:e.loginId,fid:"WEBSITE-LOGIN"},!0)},t.trackFDPEvent=function(e,t){var n="login"===e.view?"SignIn":"SignUp";Se.a.trackEvent({en:"LRSE",ltp:e.loginSource,lt:n,lm:t,iid:Se.a.generateId()})},t.handleAPIRequest=function(e,n,r,a,o,i,c){var l=t.props.dispatch(e(n)),s=t.props,p=s.pageType,d=s.loginSource,f=n&&"object"===Ie(n)&&n.loginId||c;r&&a&&l.then((function(e){return o&&t.trackOmniture(o,{pageType:p,loginSource:d,loginId:Object(S.b)(f)}),t.trackFDP({errorCode:null,isSuccess:!0,loginId:f}),r(e)}),(function(e){i&&t.trackOmniture(i,{pageType:p,loginSource:d,loginId:Object(S.b)(f)});var n=u()(e,["error","statuscode"],null);return t.trackFDP({errorCode:n,isSuccess:!1,loginId:f}),a(e)}))},t.handleAPIError=function(e,n){return Object(P.f)(e,t.props.toast,n)},t.changeViewTo=function(e,n){var r=t.props,a=r.pageType,o=r.loginSource,i=e.view===T.a.SIGNUP?"show_signup_popup":"show_login_popup";return e.view!==T.a.VERIFICATION&&e.view!==T.a.LOGIN_WITH_OTP&&a!==w.n&&t.trackOmniture(i,{pageType:a,loginSource:o}),t.setState(e),n&&n.preventDefault(),!1},t.handleLoginSuccess=function(e){t.trackFDPEvent(t.props,e);var n=t.props.onLoginSuccess;"function"==typeof n?n():window.location.reload()},t.trackOmniture=function(e,n){l()(t.props.omnitureTrackingHelper,e,n)},t.state={view:e.view||T.a.LOGIN,extra:{}},t}return t=c,(n=[{key:"componentDidMount",value:function(){var e=this.props,t=e.pageType,n=void 0===t?"":t,r=e.loginSource,a=void 0===r?"":r;if(n!==w.n){var o=this.props.view===T.a.SIGNUP?"Signup Displayed":"Login Displayed";Object(S.d)("custom",{prop21:this.props.view===T.a.SIGNUP?"".concat(n,"_").concat(a," Signup:Displayed"):"".concat(n,"_").concat(a," Login:Displayed"),events:"event12"},o)}}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){return this.setState({view:e.view||"",extra:{}})}},{key:"render",value:function(){var e=this,t=this.state,n=t.view,a=t.extra,o=void 0===a?{}:a,c=this.props,l=c.toast,s=c.viewType,f=void 0===s?"":s,g=c.overrideStyles,h=c.titleKey,b=c.descKey,y=c.pageType,v=c.loginSource,O=c.className,E=c.enableLoginPassword,S=void 0!==E&&E,_=c.enableSignupPassword,N=void 0!==_&&_,I=c.enableCOOTPView,P=void 0!==I&&I,x=Object.assign({},Ne.a,g),C=u()(this.state,["extra","signup"]),j=u()(this.state,["extra","reactivate"]),R=h||(C||"signup"===n?"signupTitleTxt":"loginTitleTxt"),k=f===w.o,L={handleAPIError:this.handleAPIError,handleAPIRequest:this.handleAPIRequest,extra:o,viewType:f,changeViewHandler:this.changeViewTo,toast:l,trackOmniture:this.trackOmniture,compactView:k,styles:x,handleLoginSuccess:this.handleLoginSuccess,pageType:y,loginSource:v,enableLoginPassword:S,enableSignupPassword:N},A=function(){switch(n){case T.a.MESSAGE_INFO:return r.createElement(m,{message:u()(e.state,["extra","message"]),styles:x});case T.a.SIGNUP:return r.createElement(B,L);case T.a.VERIFICATION:return r.createElement(me,L);case T.a.LOGIN_WITH_OTP:return r.createElement(Ee,L);default:return k&&P?r.createElement(re,L):r.createElement($,L)}};if(k&&y===w.n)return r.createElement("div",{className:x["form-view-container"]},A());var K=C||n===T.a.SIGNUP?"signupDesc":o.unverified?Object(p.h)(o.userName)?"verifyMobileDesc":"verifyEmailDesc":j?"reactivateDesc":"loginDesc";return r.createElement("div",{className:i()(x["login-widget"],"row",O)},r.createElement("div",{className:i()(x["left-container"],"col","col-2-5",Ne.a["login-img"],this.props.leftContainerClass)},r.createElement("span",{className:x.title},r.createElement(d.a,{strKey:R})),r.createElement("p",{className:x.description},r.createElement(d.a,{strKey:b||K}))),r.createElement("div",{className:i()(x["form-view-container"],"col","col-3-5")},r.createElement("div",{className:x["form-wrapper"]},A())))}}])&&Pe(t.prototype,n),a&&Pe(t,a),c}(r.Component);Re.defaultProps={viewType:"",omnitureTrackingHelper:S.d};t.default=Object(a.b)((function(e){return{enableLoginPassword:u()(e,"config.data.globalConfig.enableLoginPassword")||!1,enableSignupPassword:u()(e,"config.data.globalConfig.enableSignupPassword")||!1,enableCOOTPView:u()(e,"config.data.globalConfig.enableCOOTPView")||!1}}))(Object(N.d)(Re))}}]);